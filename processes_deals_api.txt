API для получения списка типов сущностей (смарт-процессы и сделки).

Этот модуль предоставляет эндпоинт для получения списка всех доступных типов сущностей
в системе Bitrix24 CRM. Используется фронтендом для отображения списка сущностей,
которые пользователь может выбрать для дальнейшей работы.

Основные функции:
- get_processes_and_deals() - возвращает список всех типов сущностей (смарт-процессы и сделки)

Структура ответа:
{
    "ok": true,
    "entities": [
        {
            "type": "smart_process",
            "entity_type_id": 1114,
            "entity_key": "sp:1114",
            "title": "STOCK AUTO",
            "table_name": "b24_sp_1114",
            "total": 150
        },
        {
            "type": "deal",
            "entity_key": "deal",
            "title": "CRM Deal"
        }
    ]
}

После выбора сущности на фронте, вызывается отдельный API для получения списка полей выбранной сущности.

ИСТОРИЯ ИЗМЕНЕНИЙ:
==================

2026-01-09 - Создание модуля
    - Создан файл processes_deals_api.py
    - Реализован эндпоинт GET /api/processes-deals/ для получения списка смарт-процессов и сделок
    - Добавлены функции sanitize_ident() и table_name_for_entity() для работы с именами таблиц
    - Изначально возвращал элементы смарт-процессов и сделок с полями

2026-01-09 - Упрощение ответа API
    - Убрано возвращение элементов смарт-процессов (items), оставлен только список типов с количеством
    - Убрано возвращение элементов сделок, оставлена только информация о типе
    - Убраны параметры smart_limit, smart_offset, deals_limit, deals_offset
    - API теперь возвращает только список типов сущностей для выбора на фронте
    - Для смарт-процессов добавлено поле total (количество элементов)
    - Объединены смарт-процессы и сделки в единый массив entities с полем type для различения

2026-01-09 - Добавление документации
    - Добавлена полная документация модуля в начале файла
    - Добавлена секция "ИСТОРИЯ ИЗМЕНЕНИЙ" для отслеживания всех изменений в коде
    - Документирована структура ответа API и назначение модуля

2026-01-09 - Вынос документации в отдельный файл
    - Документация перенесена из processes_deals_api.py в processes_deals_api.txt
    - Код очищен от многострочной документации для улучшения читаемости

2026-01-09 - Восстановление файла
    - Файл processes_deals_api.py был случайно удален, восстановлен на основе документации
    - Реализована функция get_processes_and_deals() для получения списка всех сущностей
    - Добавлены вспомогательные функции sanitize_ident() и table_name_for_entity()
    - API получает список смарт-процессов из таблицы b24_meta_entities
    - Для каждого смарт-процесса подсчитывается количество записей в соответствующей таблице (b24_sp_f_*)
    - Добавлена информация о сделках (type: "deal", entity_key: "deal", title: "CRM Deal")
    - Обработка ошибок при подсчете записей (если таблица не существует, пропускается)
    - Файл подключен в app.py через router
